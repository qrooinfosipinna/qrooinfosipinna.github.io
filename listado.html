<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Listado de Indicadores</title>
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/styles.css" />
</head>

<body>

  <div id="header"></div>

  <!-- CONTENIDO -->
  <h1 id="tituloTema" class="text-center flex-grow-1">Listado de Indicadores</h1>
  <main class="container my-5">
    <div id="descripcionTema" class="mb-4 text-center text-secondary"></div>

    <div class="row" id="contenedorIndicadores">
      <!-- Tarjetas generadas dinámicamente -->
    </div>
  </main>

  <!-- FOOTER -->
  <div id="footer"></div>

  <script>

    /* cargar header */
    fetch("partials/header.html")
      .then(res => res.text())
      .then(data => {
        document.getElementById("header").innerHTML = data;

        const navToggle = document.querySelector(".nav-toggle");
        const mainNav = document.getElementById("main-nav");

        if (navToggle) {
          navToggle.addEventListener("click", () => {
            mainNav.classList.toggle("nav-open");
          });
        }
      });

    /* cargar footer */
    fetch("partials/footer.html")
      .then(res => res.text())
      .then(data => {
        document.getElementById("footer").innerHTML = data;
      });

    const indicadores = {
      demografico: [
        { titulo: "Tasa de natalidad", descripcion: "Número de nacimientos por cada mil habitantes.", enlace: "indicador.html?tema=Demografico&id=1" },
        { titulo: "Distribución por edad", descripcion: "Población agrupada por grupos etarios.", enlace: "indicador.html?tema=Demografico&id=2" }
      ],
      desarrollo: [
        { titulo: "Escolaridad promedio", descripcion: "Nivel educativo medio de la población.", enlace: "indicador.html?tema=Desarrollo&id=3" },
        { titulo: "Acceso a servicios básicos", descripcion: "Disponibilidad de agua, luz y drenaje.", enlace: "indicador.html?tema=Desarrollo&id=4" }
      ],
      supervivencia: [
        { titulo: "Mortalidad infantil", descripcion: "Defunciones de menores de 1 año por cada mil nacidos vivos.", enlace: "indicador.html?tema=Supervivencia&id=5" }
      ],
      proteccion: [
        { titulo: "Casos atendidos", descripcion: "Número de casos de niñas, niños y adolescentes protegidos.", enlace: "indicador.html?tema=Proteccion&id=6" }
      ],
      participacion: [
        { titulo: "Consejos infantiles", descripcion: "Número de consejos de participación infantil activos.", enlace: "indicador.html?tema=Participacion&id=7" }
      ],
      al25: [
        { titulo: "Avance hacia el 25 al 25", descripcion: "Progreso en la meta de tener al menos un consejo infantil en cada municipio para 2025.", enlace: "indicador.html?tema=Al25&id=8" }
      ]
    };

    // Leer parámetro de la URL
    const params = new URLSearchParams(window.location.search);
    const tema = params.get("tema"); // puede ser null

    // Obtener referencias de los elementos del DOM
    const titulo = document.getElementById("tituloTema");
    const descripcion = document.getElementById("descripcionTema");
    const contenedor = document.getElementById("contenedorIndicadores");

    // Comprobar si el parámetro existe y si hay datos para él
    if (tema && indicadores[tema]) {
      titulo.textContent = `Indicadores de ${tema.charAt(0).toUpperCase() + tema.slice(1)}`;
      descripcion.textContent = `Consulta los principales indicadores del tema ${tema}.`;

      indicadores[tema].forEach(ind => {
        const card = document.createElement("div");
        card.className = "col-md-6 col-lg-4 mb-4";
        card.innerHTML = `
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h5 class="card-title">${ind.titulo}</h5>
                <p class="card-text">${ind.descripcion}</p>
                <a href="${ind.enlace}" class="btn btn-primary w-100">Ver indicador</a>
              </div>
            </div>`;
        contenedor.appendChild(card);
      });
    } else {
      // Si no se envió tema o no existe
      titulo.textContent = "Listado de Indicadores";
      descripcion.textContent = "No se mandó tema alguno.";
      contenedor.innerHTML = `
          <div class="alert alert-warning text-center mt-4">
            No se proporcionó un tema válido o no se envió ninguno.
          </div>`;
    }
  </script>
</body>

</html>